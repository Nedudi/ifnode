<h2 id="controllers">Controllers</h2>
<p>Controller is item for building routes system of <code>ifnode</code> application. </p>
<h3 id="example">Example</h3>
<p>Create simple controller for two routes <code>/</code> and <code>/api/login</code> with options.</p>
<p>View <code>index.jade</code>:</p>
<pre><code class="lang-jade"><span class="hljs-comment">// views/index.jade</span>
<span class="hljs-selector-tag">div</span> Hello World!
</code></pre>
<p>Creating controller file:</p>
<pre><code class="lang-javascript"><span class="hljs-comment">// controllers/!.js</span>
<span class="hljs-keyword">var</span> app = <span class="hljs-built_in">require</span>(<span class="hljs-string">'ifnode'</span>)(),
    main_controller = app.Controller({
        <span class="hljs-attr">name</span>: <span class="hljs-string">'main'</span>,
        <span class="hljs-attr">root</span>: <span class="hljs-string">'/'</span>
    });

main_controller.get(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">request, response</span>) </span>{
    response.render(<span class="hljs-string">'index'</span>);
});
main_controller.get(<span class="hljs-string">'/api/login'</span>, { <span class="hljs-attr">ajax</span>: <span class="hljs-literal">true</span> }, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">request, response, next</span>) </span>{
    get_user(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">err, user</span>) </span>{
        <span class="hljs-keyword">if</span>(err) { <span class="hljs-keyword">return</span> next(err); }

        request.login(user, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">err</span>) </span>{
            <span class="hljs-keyword">if</span>(err) { <span class="hljs-keyword">return</span> next(err); }

            response.redirect(<span class="hljs-string">'/'</span>);
        });
    });
});
</code></pre>
<p>Application file:</p>
<pre><code class="lang-javascript"><span class="hljs-comment">// app.js    </span>
<span class="hljs-keyword">var</span> ifnode = require('ifnode'),
    <span class="hljs-keyword">app</span> = ifnode();

<span class="hljs-comment">// run webserver</span>
<span class="hljs-keyword">app</span>.<span class="hljs-keyword">run</span>();
</code></pre>
<p>Test case:</p>
<pre><code>curl localhost:<span class="hljs-number">8080</span> <span class="hljs-meta"># status 200, <span class="hljs-meta-string">&lt;div&gt;</span>Hello World!<span class="hljs-meta-string">&lt;/div&gt;</span></span>
curl localhost:<span class="hljs-number">8080</span>/api/login <span class="hljs-meta"># status 400, Only AJAX request</span>
</code></pre>