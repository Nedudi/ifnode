<!DOCTYPE html>
<html lang="en-us">
    <head>
        <meta charset="UTF-8">
        <title>ifnode - Excellent Node.js Framework</title>
        <meta name="viewport" content="width=device-width,initial-scale=1">
        <meta name="description" content="The ifnode is a simple, flexible, super-light and pluginnable node.js framework. Allows to start developing of application right after of module install.">
        <link rel="stylesheet" type="text/css" href="/assets/css/open-sans.css?v=1.5.1" media="screen">
        <link rel="stylesheet" type="text/css" href="/assets/css/prism-default.css?v=1.5.1" media="screen">
        <link rel="stylesheet" type="text/css" href="/assets/css/normalize.css?v=1.5.1" media="screen">
        <link rel="stylesheet" type="text/css" href="/assets/css/main.css?v=1.5.1" media="screen">
    </head>
    <body>
        <header class="page-header">
            <div class="project-name">
                <a href="/">ifnode</a>
            </div>
            <div class="project-tagline">Simple, flexible, super-light and pluginnable framework</div>
            <div class="project-buttons">
                <a href="https://github.com/ifnode/ifnode" class="btn">View on GitHub</a>
            </div>
        </header>
        <main class="centered-content main-content docs">
            <aside id="toc">
    <ul>
<li><a href="/docs/intro">Introduction</a><ul>
<li><a href="/docs/intro/ideology">Ideology</a></li>
</ul>
</li>
<li><a href="/docs/install">Install</a></li>
<li><a href="/docs/app">Application Items</a><ul>
<li><a href="/docs/app/structure">Structure</a></li>
<li><a href="/docs/app/file">app.js</a></li>
<li><a href="/docs/app/config">Config</a><ul>
<li><a href="/docs/app/config/default">Default config</a></li>
<li><a href="/docs/app/config/middleware">Middleware</a></li>
</ul>
</li>
<li><a href="/docs/app/extensions">Extensions</a></li>
<li><a href="/docs/app/models">Models</a></li>
<li><a href="/docs/app/components">Components</a></li>
<li><a href="/docs/app/controllers">Controllers</a></li>
<li><a href="/docs/app/plugins">Plugins</a><ul>
<li><a href="/docs/app/plugins/component">component</a></li>
<li><a href="/docs/app/plugins/controller">controller</a></li>
<li><strong>schema</strong></li>
</ul>
</li>
</ul>
</li>
<li><a href="/docs/api">API</a><ul>
<li><a href="/docs/api/ifnode">ifnode</a></li>
<li><a href="/docs/api/iconnectionserver">IConnectionServer</a></li>
<li><a href="/docs/api/app">app</a><ul>
<li><a href="/docs/api/app/model">app.Model</a></li>
<li><a href="/docs/api/app/component">app.Component</a></li>
<li><a href="/docs/api/app/controller">app.Controller</a></li>
</ul>
</li>
</ul>
</li>
</ul>

</aside>
<section id="docs">
    <h2 id="schema-plugin">Schema plugin</h2>
<p>Possibility to create own schema plugin to <code>ifnode</code>.</p>
<p>Schema is middleware between <code>ifnode</code> models and database module (mongoose, knex, etc).</p>
<h3 id="creating-own-plugin">Creating own plugin</h3>
<p>Below example of simple plugin <code>memorystore</code> for store data in RAM:</p>
<p>Plugin file:</p>
<pre><code class="lang-javascript"><span class="token comment" spellcheck="true">// extensions/memorystore.js    </span>
<span class="token keyword">var</span> util <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'util'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

exports<span class="token punctuation">.</span>schema <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span>app<span class="token punctuation">,</span> MemoryStore<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment" spellcheck="true">// name of schema</span>
    MemoryStore<span class="token punctuation">.</span>schema <span class="token operator">=</span> <span class="token string">'memory'</span><span class="token punctuation">;</span>

    <span class="token comment" spellcheck="true">// initialize method for each new model instance</span>
    MemoryStore<span class="token punctuation">.</span>fn<span class="token punctuation">.</span>initialize <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span>model_config<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        util<span class="token punctuation">.</span><span class="token function">_extend</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> model_config<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token keyword">this</span><span class="token punctuation">.</span>_values <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>table <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>table <span class="token operator">||</span> <span class="token keyword">this</span><span class="token punctuation">.</span>name<span class="token punctuation">;</span>

        <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>

    <span class="token comment" spellcheck="true">// create ended model which accessing by app.models['name']</span>
    MemoryStore<span class="token punctuation">.</span>fn<span class="token punctuation">.</span>compile <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>

    MemoryStore<span class="token punctuation">.</span>fn<span class="token punctuation">.</span><span class="token keyword">set</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span>key<span class="token punctuation">,</span> value<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>_values<span class="token punctuation">[</span>key<span class="token punctuation">]</span> <span class="token operator">=</span> value<span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
    MemoryStore<span class="token punctuation">.</span>fn<span class="token punctuation">.</span><span class="token keyword">get</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">typeof</span> key <span class="token operator">===</span> <span class="token string">'undefined'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>_values<span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
            <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>_values<span class="token punctuation">[</span>key<span class="token punctuation">]</span> <span class="token operator">||</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
    MemoryStore<span class="token punctuation">.</span>fn<span class="token punctuation">.</span>remove <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">delete</span> <span class="token keyword">this</span><span class="token punctuation">.</span>_values<span class="token punctuation">[</span>key<span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
    MemoryStore<span class="token punctuation">.</span>fn<span class="token punctuation">.</span>has <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> key <span class="token keyword">in</span> <span class="token keyword">this</span><span class="token punctuation">.</span>_values<span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>

    MemoryStore<span class="token punctuation">.</span>fn<span class="token punctuation">.</span>to_array <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">var</span> values <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>_values<span class="token punctuation">,</span>
            keys <span class="token operator">=</span> Object<span class="token punctuation">.</span><span class="token function">keys</span><span class="token punctuation">(</span>values<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token keyword">return</span> keys<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">return</span> values<span class="token punctuation">[</span>key<span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre>
<p>Model file:</p>
<pre><code class="lang-javascript"><span class="token comment" spellcheck="true">// models/users.js    </span>
<span class="token keyword">var</span> app <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'ifnode'</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    users_model <span class="token operator">=</span> app<span class="token punctuation">.</span><span class="token function">Model</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
        name<span class="token punctuation">:</span> <span class="token string">'users'</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

users_model<span class="token punctuation">.</span>get_all <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">to_array</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre>
<p>Application file:</p>
<pre><code class="lang-javascript"><span class="token comment" spellcheck="true">// app.js    </span>
<span class="token keyword">var</span> ifnode <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'ifnode'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    app <span class="token operator">=</span> <span class="token function">ifnode</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

app<span class="token punctuation">.</span><span class="token function">register</span><span class="token punctuation">(</span><span class="token string">'memorystore'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
app<span class="token punctuation">.</span><span class="token function">load</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

app<span class="token punctuation">.</span>models<span class="token punctuation">.</span>users<span class="token punctuation">.</span><span class="token keyword">set</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> id<span class="token punctuation">:</span> <span class="token number">1</span><span class="token punctuation">,</span> name<span class="token punctuation">:</span> <span class="token string">'ilfroloff'</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
app<span class="token punctuation">.</span>models<span class="token punctuation">.</span>users<span class="token punctuation">.</span><span class="token function">get_all</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// [{ id: 1, name: 'ilfroloff' }]</span>
</code></pre>
<h2 id="real-examples">Real examples</h2>
<ul>
<li><strong><a href="https://github.com/ifnode/ifnode/blob/master/plugins/ifnode-virtual/index.js">ifnode-virtual</a></strong></li>
<li><strong><a href="https://github.com/ifnode/mongoose">ifnode-mongoose</a></strong></li>
</ul>

</section>
<section id="toc-page">
    <a href="/docs/toc">Table of Content</a>
</section>

        </main>
        <footer class="page-footer">
            <span class="owner">
                <a href="https://github.com/ifnode/ifnode">ifnode</a> is maintained by <a href="https://github.com/ilfroloff">Ilya Frolov</a> ©
            </span>
        </footer>
    </body>
</html>
